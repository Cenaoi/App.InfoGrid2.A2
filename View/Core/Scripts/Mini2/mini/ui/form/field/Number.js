Mini2.define("Mini2.ui.form.field.Number",{extend:"Mini2.ui.form.field.Text",allowDecimals:true,decimalSeparator:".",submitLocaleSeparator:true,decimalPrecision:2,minValue:Number.NEGATIVE_INFINITY,maxValue:Number.MAX_VALUE,step:1,value:0,defaultValue:0,align:"right",initComponent:function(){var a=this;$(a).muBind("focusout",function(){a.fieldEl.removeClass("mi-form-focus");a.el.removeClass("mi-form-trigger-wrap-focus")});a.initLabelable()},getValue:function(){var b=this,a=b.defaultValue;var c=this.constructor.base.getValue.call(this);if(c==""){return null}c=Mini2.Number.from(c,a);return c},setMinValue:function(c){var b=this,a;b.minValue=Mini2.Number.from(c,Number.NEGATIVE_INFINITY);b.toggleSpinners();if(b.disableKeyFilter!==true){a=b.baseChars+"";if(b.allowExponential){a+=b.decimalSeparator+"e+-"}else{if(b.allowDecimals){a+=b.decimalSeparator}if(b.minValue<0){a+="-"}}a=Mini2.String.escapeRegex(a);b.maskRe=new RegExp("["+a+"]");if(b.autoStripChars){b.stripCharsRe=new RegExp("[^"+a+"]","gi")}}},setMaxValue:function(a){this.maxValue=Mini2.Number.from(a,Number.MAX_VALUE);this.toggleSpinners()},toggleSpinners:function(){var b=this,c=b.getValue(),d=c===null,a;if(b.spinUpEnabled||b.spinUpDisabledByToggle){a=d||c<b.maxValue;b.setSpinUpEnabled(a,true)}if(b.spinDownEnabled||b.spinDownDisabledByToggle){a=d||c>b.minValue;b.setSpinDownEnabled(a,true)}},rawToValue:function(a){var b=this.fixPrecision(this.parseValue(a));if(b===null){b=a||null}return b},valueToRaw:function(c){var b=this,a=b.decimalSeparator;c=b.parseValue(c);c=b.fixPrecision(c);c=Mini2.isNumber(c)?c:parseFloat(String(c).replace(a,"."));c=isNaN(c)?"":String(c).replace(".",a);return c},parseValue:function(a){a=parseFloat(String(a).replace(this.decimalSeparator,"."));return isNaN(a)?null:a},fixPrecision:function(d){var a=this,b=isNaN(d),c=a.decimalPrecision;if(b||!d){return b?"":d}else{if(!a.allowDecimals||c<=0){c=0}}return parseFloat(Mini2.Number.toFixed(parseFloat(d),c))},setSpinValue:function(c){var b=this,a;b.setValue(c)},onSpinUp:function(){var a=this;if(!a.readOnly){a.setSpinValue(Mini2.Number.constrain(a.getValue()+a.step,a.minValue,a.maxValue))}},onSpinDown:function(){var a=this;if(!a.readOnly){a.setSpinValue(Mini2.Number.constrain(a.getValue()-a.step,a.minValue,a.maxValue))}},spinUpEnabled:function(a){var b=this;if(a){b.onSpinUp();if(!b.spinUpDisabledByToggle){b.spinUpDisabledByToggle=setInterval(function(){b.onSpinUp()},200)}}else{if(b.spinUpDisabledByToggle){clearInterval(b.spinUpDisabledByToggle);delete b.spinUpDisabledByToggle}}},spinDownEnabled:function(a){var b=this;if(a){b.onSpinDown();if(!b.spinDownDisabledByToggle){b.spinDownDisabledByToggle=setInterval(function(){b.onSpinDown()},200)}}else{if(b.spinDownDisabledByToggle){clearInterval(b.spinDownDisabledByToggle);delete b.spinDownDisabledByToggle}}},btnUp_Click:function(a){var b=a.data;b.onSpinUp();b.focus();Mini2.EventManager.stopEvent()},btnDown_Click:function(a){var b=a.data;b.onSpinDown();b.focus();Mini2.EventManager.stopEvent()},bindInputEl_Key:function(a){var b=this;$(a).bind("keydown",function(c){var d=c.keyCode;if(d==38){b.onSpinUp();Mini2.EventManager.stopEvent()}else{if(d==40){b.onSpinDown();Mini2.EventManager.stopEvent(c)}else{b.on("keydown",c)}}}).bind("keyup",function(c){b.on("keyup",c)}).bind("keypress",function(c){b.on("keypress",c)})},getFieldEl:function(){var d=this;var e=Mini2.$joinStr(['<table class="mi-form-trigger-wrap" cellpadding="0" cellspacing="0" style="table-layout: fixed; width: 100%; ">',"<tbody>","<tr>",'<td class="mi-form-trigger-input-cell" style="width: 100%; "></td>','<td valign="top" class="mi-trigger-cell"></td>',"</tr>","</tbody>","</table>"]);var c=Mini2.$joinStr(['<input type="text" class="mi-form-field mi-form-required-field mi-form-text" ','autocomplete="off" aria-invalid="false" data-errorqtip="" style="width: 100%; ">']);var b=Mini2.$joinStr(['<div class="mi-trigger-index-0 mi-form-trigger mi-form-spinner-up" role="button"></div>']);var a=Mini2.$joinStr(['<div class="mi-trigger-index-1 mi-form-trigger mi-form-spinner-down" role="button"></div>']);c.attr("id",d.clientId);c.val(d.value);if(d.name){c.attr("name",d.name)}d.appendCell(e,c,"td.mi-form-trigger-input-cell");d.appendCell(e,b,"td.mi-trigger-cell");d.appendCell(e,a,"td.mi-trigger-cell");b.muBind("mousedown",d,function(f){d.focus();d.spinUpEnabled(true)});b.muBind("mouseup",d,function(f){d.spinUpEnabled(false);Mini2.EventManager.stopEvent(f)});a.muBind("mousedown",d,function(){d.focus();d.spinDownEnabled(true)});a.muBind("mouseup",d,function(f){d.spinDownEnabled(false);Mini2.EventManager.stopEvent(f)});d.bindInputEl_Mouse(c);d.bindInputEl_Key(c);d.inputEl=c;return e},render:function(){var a=this;a.baseRender();a.inputEl.css("padding-right","0px");a.el.data("me",a)}});